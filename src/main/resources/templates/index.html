<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>메인 레이아웃</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
</head>
<body data-assetname="BTC">
<div id="header"></div>
<main class="container py-4">
    <div class="row g-4 main-layout d-flex justify-content-center">

        <!-- 왼쪽 컬럼 -->
        <div class="col-12 col-md-4 d-flex flex-column">

            <!-- 환율 보드 -->
            <div class="content-box exchange-rate" style="width: 500px; height: 250px; overflow-y:auto;">
                <h5>일별 환율 (원/달러)</h5>
                <table class="table table-sm table-bordered text-center align-middle">
                    <thead class="table-light">
                    <tr>
                        <th>날짜</th>
                        <th>현재가</th>
                        <th>전일대비 등락금액</th>
                        <th>전일대비 등락률</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="row : ${usdRates}">
                        <td th:text="${row.date}"></td>
                        <td th:text="${row.price}"></td>
                        <td th:text="${row.priceChange}"
                            th:classappend="${row.priceChangeAsDouble > 0} ? 'text-danger' : (${row.priceChangeAsDouble < 0} ? 'text-primary' : '')">
                        </td>
                        <td th:text="${row.changePercent}"
                            th:classappend="${row.changePercentAsDouble > 0} ? 'text-danger' : (${row.changePercentAsDouble < 0} ? 'text-primary' : '')">
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <!-- 주식 -->
            <div class="content-box stock">주식</div>

            <!-- 코인 -->
            <div class="content-box coin">
                <div id="wrap">
                    <canvas id="candle"></canvas>
                </div>
                <div id="empty">
                    표시할 데이터가 없습니다.
                </div>
            </div>
        </div>

        <!-- 가운데 컬럼 -->
        <div class="col-12 col-md-4 d-flex flex-column">
            <!-- 뉴스 -->
            <div class="content-box news">
                <h5>뉴스</h5>
                <ul class="news-list">
                    <li th:each="news : ${newsList}">
                        <a th:href="${news.link}" th:utext="${news.title}" target="_blank"></a>
                        <span style="font-size:12px; color:#999;" th:text="${news.time}"></span>
                    </li>
                </ul>
            </div>

            <!-- 게시판 -->
            <div class="content-box board">게시판</div>
        </div>

        <!-- 오른쪽 컬럼 (광고) -->
        <div class="col-12 col-md-4">
            <div class="col-md-4">
                <div class="content-box ad d-flex justify-content-center align-items-start">
                    <div class="ad-section">
                        <!-- 광고 이미지 로테이션 -->
                        <img id="adImage" src="/image/ad1.jpeg" alt="광고"
                             style="width:200px; height:auto; margin:5px;">
                    </div>
                </div>
            </div>
        </div>

    </div>
</main>
<div id="footer"></div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/main.js}"></script>

<script>
    // 광고 이미지 자동 순환 (3초마다 변경)
    const adImages = ["/image/ad1.jpeg", "/image/ad2.jpeg", "/image/ad3.jpeg"];
    let currentAd = 0;
    const adElement = document.getElementById("adImage");

    setInterval(() => {
        currentAd = (currentAd + 1) % adImages.length;
        adElement.src = adImages[currentAd];
    }, 3000);
</script>
</body>
</html>
